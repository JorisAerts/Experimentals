on: [push]

jobs:

  compile-linux:
    name: Compile on Linux
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: Pre-Compile
      run: g++ -c -fPIC -I${JAVA_HOME}/include -I${JAVA_HOME}/include/linux EnvironmentLib.cc -o EnvironmentLib.o
    - name: Compile
      run: g++ -shared -fPIC -o EnvironmentLib.so EnvironmentLib.o -lc

  compile-windows:
    name: Compile on Windows
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v1
    - name: Pre-Compile
      run: "g++ -c $('-I' + $env:JAVA_HOME + '\\include') $('-I' + $env:JAVA_HOME + '\\include\\win32') EnvironmentLib.cc -o EnvironmentLib.o"
    - name: Compile
      run: "g++ -shared -o EnvironmentLib.dll EnvironmentLib.o $('-Wl,--add-stdcall-alias')"


  compile-macos:
    name: compile on macOS
    runs-on: macos-latest
    steps:
    - uses: actions/checkout@v1
    - name: Pre-Compile
      run: g++ -c -fPIC -I${JAVA_HOME}/include -I${JAVA_HOME}/include/darwin EnvironmentLib.cc -o EnvironmentLib.o
    - name: Compile
      run: g++ -dynamiclib -o EnvironmentLib.dylib EnvironmentLib.o -lc
